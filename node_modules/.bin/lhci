'use strict';

const {spawnSync} = require('node:child_process');

/**
 * Lightweight binstub wrapper.
 * This file should be generated by the package manager install step.
 */
function resolveLhciCliEntrypoint() {
  try {
    return require.resolve('@lhci/cli/src/cli.js');
  } catch (e) {
    process.stderr.write(
      [
        'Unable to find @lhci/cli. Dependencies are not installed.',
        'Run `npm ci` (preferred) or `npm install` and try again.',
        '',
      ].join('\n')
    );
    process.exit(1);
  }
}

const cliPath = resolveLhciCliEntrypoint();
const result = spawnSync(process.execPath, [cliPath, ...process.argv.slice(2)], {
  stdio: 'inherit',
  env: process.env,
});

process.exit(typeof result.status === 'number' ? result.status : 1);